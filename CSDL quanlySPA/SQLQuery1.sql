--tao CSDL ten la "quanlySPA"
-- code duoi day --
CREATE DATABASE SpaManagement

GO

USE SpaManagement
GO

---------hien_san
CREATE TABLE KHACHHANG(
	MAKH NVARCHAR(100),
	HOTEN NVARCHAR(100) NOT NULL,
	GIOITINH INT NOT NULL,
	NAMSINH DATE NOT NULL,
	DIENTHOAI NVARCHAR(50) NOT NULL,
	PRIMARY KEY (MAKH)
)
GO
CREATE TABLE LIEUTRINH(
	MALT NVARCHAR(100),
	TENLT NVARCHAR(100),
	THOIGIANDT INT,
	GIATIEN INT,
	PRIMARY KEY (MALT)
)
GO
CREATE TABLE CTDT(
	MABS NVARCHAR(100),
	MALT NVARCHAR(100),
	SOHD NVARCHAR(100),
	SOLUONG INT,
	THANHTIENLT INT,
	PRIMARY KEY (MABS,MALT,SOHD)
)
GO

----Viz
CREATE TABLE HOADON(
    SOHD NVARCHAR(100),
	MAKH NVARCHAR(100),
	TONGTIEN INT,
	MANV NVARCHAR(100),
	NGAYTAO DATE,
	PRIMARY KEY (SOHD)
)
GO
CREATE TABLE CTHD(
    SOHD NVARCHAR(100),
	MAMP NVARCHAR(100),
	THANHTIENMP INT,
	SOLUONG INT,
	PRIMARY KEY (SOHD,MAMP)
)
GO
CREATE TABLE QLBS(
    MABS NVARCHAR(100),
	HOTEN NVARCHAR(100) NOT NULL,
	GIOITINH INT NOT NULL,
	SDT NVARCHAR(50) NOT NULL,
	LUONG INT,
	NBDHD DATE NOT NULL,
	NKTHD DATE NOT NULL,
	PRIMARY KEY (MABS)
)
GO



-----Bach san
CREATE TABLE QLNV(
	MANV NVARCHAR(100),
	HOTEN NVARCHAR(100) NOT NULL,
	GIOITINH INT NOT NULL,
	SDT NVARCHAR(50) NOT NULL,	
	NBDHD DATE NOT NULL,
	NKTHD DATE NOT NULL,
	PASS NVARCHAR(100) NOT NULL,
	LUONG INT,
	PRIMARY KEY (MANV),
)
GO
CREATE TABLE MYPHAM(
	MAMP NVARCHAR(100),
	TENMP NVARCHAR(100) NOT NULL,
	SOLUONGTONKHO INT NOT NULL,
	GIABAN INT NOT NULL, 
	PRIMARY KEY (MAMP),
)
GO

-----Nhan
CREATE TABLE LUONGBS(
	MABS NVARCHAR(100),
	MATT NVARCHAR(100),
	NGAYTT DATE NOT NULL,
	TIENTHUONG INT,
	TONGTIEN INT,
	PRIMARY KEY (MATT)
)
GO
CREATE TABLE LUONGNV(
	MANV NVARCHAR(100),
	MATT NVARCHAR(100),
	NGAYTT DATE NOT NULL,
	TONGTIEN INT,
	PRIMARY KEY (MATT)
)
GO

CREATE TABLE NHAPMP(
	MANMP NVARCHAR(100),
	MAMP NVARCHAR(100),
	DONGIA INT,
	NGAYNHAP DATE NOT NULL,
	SLNHAP INT,
	THANHTIENDH INT,
	MANV NVARCHAR(100),
	PRIMARY KEY (MANMP)
)
GO
ALTER TABLE HOADON ADD CONSTRAINT fk_HD_KH FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH)
GO
ALTER TABLE CTHD ADD CONSTRAINT fk_CTHD_MP FOREIGN KEY(MAMP) REFERENCES MYPHAM(MAMP)
GO
ALTER TABLE CTHD ADD CONSTRAINT fk_CTHD_HD FOREIGN KEY(SOHD) REFERENCES HOADON(SOHD)
GO
ALTER TABLE HOADON ADD CONSTRAINT fk_HD_QLNV FOREIGN KEY(MANV) REFERENCES QLNV(MANV)
GO
ALTER TABLE CTDT ADD CONSTRAINT fk_CTHD_HOADON FOREIGN KEY (SOHD) REFERENCES HOADON(SOHD)
GO
ALTER TABLE CTDT ADD CONSTRAINT fk_CTHD_QLBS FOREIGN KEY (MABS) REFERENCES QLBS(MABS)
GO
ALTER TABLE CTDT ADD CONSTRAINT fk_CTHD_LT FOREIGN KEY (MALT) REFERENCES LIEUTRINH(MALT)
GO
ALTER TABLE LUONGBS ADD CONSTRAINT fk_LUONGBS_QLBS FOREIGN KEY (MABS) REFERENCES QLBS(MABS)
GO
ALTER TABLE LUONGNV ADD CONSTRAINT fk_LUONGNV_QLNV FOREIGN KEY (MANV) REFERENCES QLNV(MANV)
GO
ALTER TABLE NHAPMP ADD CONSTRAINT fk_NHAPMP_QLNV FOREIGN KEY (MANV) REFERENCES QLNV(MANV)
GO
ALTER TABLE NHAPMP ADD CONSTRAINT fk_NHAPMP_MYPHAM FOREIGN KEY (MAMP) REFERENCES MYPHAM(MAMP)
GO
INSERT INTO QLNV(MANV, HOTEN, GIOITINH,SDT,NBDHD,NKTHD,PASS,LUONG) VALUES ('NV0','admin_' , '1','1','12-19-2001','12-19-2021','123456','1')
GO
